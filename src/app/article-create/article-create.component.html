<div>

  <mat-card>
    <mat-card-header>
      <h3>New article creation</h3>
    </mat-card-header>
    <mat-card-content>

      <div id="data-loading-indication">

        <mat-spinner
          *ngIf="dataIsLoading | async"
          class="center-inside"
          [diameter]="24"
        ></mat-spinner>

        <button
          *ngIf="user == null && !(dataIsLoading | async)"
          class="default-margin-left"
          mat-raised-button
          color="warn"
          type="button"
          (click)="onDataRefreshClicked()"
        >Refresh</button>

      </div>

      <div *ngIf="user!=null && languagesListFromApi!=null" id="articleFormContainer">

        <form
          [formGroup]="articleCreateFormGroup"
          name="accountEditForm"
          (ngSubmit)="onArticleCreateClicked()"
        >

          <mat-card>
            <mat-card-header>
              <!--@formatter:off-->
              <div class="mat-input-element">
                <mat-checkbox
                  formControlName="isOriginalCheckBox"
                  name="isOriginalCheckBox"
                  color="primary"
                  (change)="onArticleIsOriginalClicked($event.checked)"
                >Article is original</mat-checkbox>
              </div>

              <!--@formatter:on-->
            </mat-card-header>
            <mat-card-content>

              <!--              todo 3 optional inputs, depended on checkbox above-->
              <div id="input-source-title" class="mat-input-element">
                <mat-form-field class="full-width-field">
                  <label>
                    <input
                      matInput
                      formControlName="title"
                      placeholder="Title"
                      name="title"
                      [required]="!articleIsOriginal"
                      (change)="onTitleChanged($event.target.value)"
                    >
                  </label>
                  <mat-error
                    *ngIf="articleCreateFormGroup.controls.title.errors?.required">You must provide title</mat-error>
                </mat-form-field>
              </div>
            </mat-card-content>
          </mat-card>

          <div id="input-title" class="mat-input-element">
            <mat-form-field class="full-width-field">
              <label>
                <input
                  matInput
                  formControlName="title"
                  placeholder="Title"
                  name="title"
                  required
                  (change)="onTitleChanged($event.target.value)"
                >
              </label>
              <mat-error
                *ngIf="articleCreateFormGroup.controls.title.errors?.required">You must provide title</mat-error>
            </mat-form-field>
          </div>

          <div id="input-shortDescription" class="mat-input-element">
            <mat-form-field class="full-width-field">
              <label>
                <textarea
                  matInput
                  formControlName="shortDescription"
                  placeholder="Short description"
                  name="shortDescription"
                  (change)="onShortDescriptionChanged($event.target.value)"
                  rows="4"
                ></textarea>
              </label>
            </mat-form-field>
          </div>

          <div fxLayout="row" fxLayoutGap="16px">
            <mat-form-field class="full-width-field">
              <mat-label>Primary language</mat-label>

              <mat-select
                formControlName="primaryLanguageSelect"
                [errorStateMatcher]="matcher"
                required
                (selectionChange)="onPrimaryLanguageChanged($event.value)"
              >
                <mat-option
                  *ngFor="let language of languagesListFromApi"
                  [value]="language">{{language.langCode.toUpperCase()}}
                </mat-option>
              </mat-select>

              <mat-error *ngIf="articleCreateFormGroup.controls.primaryLanguageSelect.errors?.required"
              >You must make a selection</mat-error>

            </mat-form-field>

          </div>

          <p>
            <button
              mat-raised-button
              color="accent"
              type="submit"
              [disabled]="!(articleCreateFormGroup.dirty && articleCreateFormGroup.valid)"
            >Save</button>
          </p>

        </form>

      </div>
    </mat-card-content>
  </mat-card>


</div>
